@model TenantManagementSystem.Models.TenancyAgreement
@{
    ViewBag.Title = "Tenancy";
    Layout = "~/Views/Shared/_MasterLayoutPage.cshtml";
}

<!DOCTYPE html>

<h2>Save Tenancy Agreement</h2>

@section styles
    {
    <style>
        .field-validation-error {
            color: red;
        }
    </style>
}
<link href="~/Content/BackEnd/css/jqueryUI.css" rel="stylesheet" />
<link href="~/Content/BackEnd/css/jqueryUI.css" rel="stylesheet" />
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

<section class="wrapper">
    <div class="form-w3layouts">
        <div class="row">
            <div class="col-lg-12">
                <section class="panel">
                    <header class="panel-heading">
                        Save Tenancy Agreement
                    </header>
                    <div class="panel-body">
                        <div class="position-center">
                            @{
                                if (ViewBag.Message == null)
                                { }
                                else
                                {
                                    <div class="alert alert-success" role="alert">
                                        <strong>@ViewBag.Message</strong>
                                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                }
                            }
                            @using (Html.BeginForm(null, null, FormMethod.Post))
                            {

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.AgreementNumber)
                                    @Html.TextBoxFor(TenancyAgreement => TenancyAgreement.AgreementNumber, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.AgreementNumber)
                                </div>

                                @*<div class="form-group">
                                        @Html.LabelFor(TenancyAgreement => TenancyAgreement.LessorId)
                                        @Html.TextAreaFor(TenancyAgreement => TenancyAgreement.LessorId, new { @class = "form-control" })
                                        @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.LessorId)
                                    </div>*@

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.LessorId)
                                    @Html.DropDownListFor(TenancyAgreement => TenancyAgreement.LessorId, new SelectList(ViewBag.Lessor, "Id", "Name"), "------Select Lessor------", new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.LessorId)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.BuildingId)
                                    @Html.DropDownListFor(TenancyAgreement => TenancyAgreement.BuildingId, new SelectList(ViewBag.Building, "Id", "Name"), "------Select Building------", new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.BuildingId)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.FlatId)
                                    @Html.DropDownListFor(TenancyAgreement => TenancyAgreement.FlatId, new SelectList(ViewBag.Flat, "Id", "Name"), "------Select Flat------", new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.FlatId)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.StartDate)
                                    @Html.TextBoxFor(TenancyAgreement => TenancyAgreement.StartDate, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.StartDate)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.EndDate)
                                    @Html.TextBoxFor(TenancyAgreement => TenancyAgreement.EndDate, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.EndDate)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.RentDurationinDays)
                                    @Html.TextBoxFor(TenancyAgreement => TenancyAgreement.RentDurationinDays, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.RentDurationinDays)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.RentDurationinMonths)
                                    @Html.TextBoxFor(TenancyAgreement => TenancyAgreement.RentDurationinMonths, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.RentDurationinMonths)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.MonthlyAmount)
                                    @Html.TextBoxFor(TenancyAgreement => TenancyAgreement.MonthlyAmount, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.MonthlyAmount)
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.TotalAmount)
                                    @Html.TextBoxFor(TenancyAgreement => TenancyAgreement.TotalAmount, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.TotalAmount)
                                </div>
                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.IsStarted)
                                    @Html.CheckBoxFor(TenancyAgreement => TenancyAgreement.IsStarted, new { @class = "form-control" })
                                    @*@Html.CheckBoxFor(TenancyAgreement => TenancyAgreement.IsStarted)*@
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.IsStarted)
                                </div>
                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.IsCompleted)
                                    @Html.CheckBoxFor(TenancyAgreement => TenancyAgreement.IsCompleted, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.IsCompleted)
                                </div>
                                <div class="form-group">
                                    @Html.LabelFor(TenancyAgreement => TenancyAgreement.IsCancelled)
                                    @Html.CheckBoxFor(TenancyAgreement => TenancyAgreement.IsCancelled, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(TenancyAgreement => TenancyAgreement.IsCancelled)
                                </div>

                                <button type="submit" class="btn btn-info">Save</button>
                            }
                        </div>

                        <br /><br />

                    </div>

                    @*grids added*@

                    @*newtable added*@
                    <style>
                        table {
                            width: 100%;
                            margin: 20px 0;
                            border-collapse: collapse;
                        }

                        table, th, td {
                            border: 1px solid #cdcdcd;
                        }

                            table th, table td {
                                padding: 5px;
                                text-align: left;
                            }
                    </style>
                    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
                    <script>
                        $(document).ready(function () {
                            $(".add-row").click(function () {
                                var name = $("#name").val();
                                var email = $("#email").val();
                                var markup = "<tr><td><input type='checkbox' name='record'></td><td>" + name + "</td><td>" + email + "</td></tr>";
                                $("table tbody").append(markup);
                            });

                            // Find and remove selected table rows
                            $(".delete-row").click(function () {
                                $("table tbody").find('input[name="record"]').each(function () {
                                    if ($(this).is(":checked")) {
                                        $(this).parents("tr").remove();
                                    }
                                });
                            });
                        });
                    </script>


                    <form>
                        <input type="text" id="name" placeholder="Name">
                        <input type="text" id="email" placeholder="Email Address">
                        <input type="button" class="add-row" value="Add Row">
                    </form>
                    <table>
                        <thead>
                            <tr>
                                <th>Cheque Details</th>

                                <th>Select</th>
                                <th>Cheque Number</th>
                                <th>Cheque Date</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="checkbox" name="record"></td>
                                <td>CHK-0012356</td>
                                <td><input type="date" /></td>
                            </tr>
                        </tbody>
                    </table>
                    <button type="button" class="delete-row">Delete Row</button>





                    @*<div class="panel-body">
                        <h4>Cheque Details</h4>
                        <table style=" width: 70%;">
                            <tr>
                                <td>&nbsp;&nbsp; ChequeNumber</td>
                                <td>&nbsp;&nbsp;ChequeDate</td>
                                <td>&nbsp;&nbsp;TenantAgreementNumber</td>
                                <td>&nbsp;&nbsp;Amount</td>
                                <td>&nbsp;</td>*@
                    @*<td>IsCashed</td>*@
                    @*</tr>
                        <tr>
                            <td>
                                <input type="text" id="ChequeNumber" />
                            </td>
                            <td><input type="date" id="ChequeDate" /></td>
                            <td><input type="text" id="TenantAgreementNumber" /></td>
                            <td><input type="number" id="Amount" /></td>*@

                    @*<td><input type="checkbox" id="ischecked" /></td>*@
                    @*</tr>
                            </table>
                            <div id="ChequeDetails" class="tablecontainer">

                            </div>
                            <div style="padding: 10px 0px; text-align: right;"></div>
                            <button id="add" type="submit" class="btn btn-primary">Add</button>


                        </div>*@


                </section>

            </div>
        </div>
    </div>
</section>


@section scripts
    {
    <script src="~/Scripts/jquery.validate.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.js"></script>
    <script src="~/Content/BackEnd/js/jqueryUI.js"></script>
    <script src="~/Content/BackEnd/js/timepicker.js"></script>
    <script src="~/Scripts/datepair.js"></script>
    <script src="~/Scripts/jqdatepair.js"></script>
    <script src="@Url.Content("~/Scripts/jquery-1.10.2.min.js")"></script>
    <script src="@Url.Content("~/Scripts/gridmvc.min.js")"></script>


    <script>
        document.getElementById('Id').value = '';
        document.getElementById('AgreementNumber').value = '';
        document.getElementById('LessorId').value = '';
        document.getElementById('BuildingId').value = '';
        document.getElementById('FlatId').value = '';
        document.getElementById('StartDate').value = '';
        document.getElementById('EndDate').value = '';
        document.getElementById('RentDurationinDays').value = '';
        document.getElementById('RentDurationinMonths').value = '';
        document.getElementById('MonthlyAmount').value = '';
        document.getElementById('TotalAmount').value = '';
    </script>

    <script>
        $().ready(function () {

            $("#StartDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: "yy-mm-dd"
            }).datepicker('setDate', 'today');

            $("#EndDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: "yy-mm-dd",
            }).datepicker('setDate', 'today');
            $("#EndDate").datepicker();

            $("#EndDate").on('change', function () {
                var date = Date.parse($(this).val());
                if (date < Date.now()) {
                    alert('Selected date must be greater than today date');
                    $(this).val('');
                }
                var start = $("#StartDate").datepicker("getDate");
                var end = $("#EndDate").datepicker("getDate");
                days = (end - start) / (1000 * 60 * 60 * 24);
                //alert(Math.round(days));
                $("#RentDurationinDays").val(Math.round(days));
                $("#RentDurationinMonths").val(Math.round(days / 30));
            });

            $("#MonthlyAmount").on('change', function () {
                var monthlyAmount = Number.parseFloat($(this).val());
                var rentDurationinMonths = Number.parseFloat($("#RentDurationinMonths").val());

                $("#TotalAmount").val(Math.round(monthlyAmount * rentDurationinMonths));
            });

        });



        //$(document).ready(function () {
        //    var ChequeDetails = [];

        //    //Add button click
        //    $('#add').click(function () {
        //        //check validation of order items
        //        //var isValidItem = true;
        //        var isValidItem = true;
        //        if ($('#ChequeNumber').val().trim() == '') {
        //            isValidItem = false;
        //            $('#ChequeNumber').siblings('span.error').css('visibility', 'visibile')

        //        }
        //        else {
        //            $('#ChequeNumber').siblings('span.error').css('visibility', 'hidden')
        //        }
        //        if (!($('#TenantAgreementNumber').val().trim() != '' && !isNaN($('#TenantAgreementNumber').val().trim()))) {
        //            isValidItem = false;
        //            $('#TenantAgreementNumber').siblings('span.error').css('visibility', 'visibile')

        //        }
        //        else {
        //            $('#TenantAgreementNumber').siblings('span.error').css('visibility', 'hidden')
        //        }

        //        if (!($('#Amount').val().trim() != '' && !isNaN($('#Amount').val().trim()))) {
        //            isValidItem = false;
        //            $('#Amount').siblings('span.error').css('visibility', 'visibile')

        //        }
        //        else {
        //            $('#Amount').siblings('span.error').css('visibility', 'hidden')
        //        }
        //        if (!($('#ChequeDate').val().trim() != '' && !isNaN($('#ChequeDate').val().trim()))) {
        //            isValidItem = false;
        //            $('#ChequeDate').siblings('span.error').css('visibility', 'visibile')

        //        }
        //        else {
        //            $('#ChequeDate').siblings('span.error').css('visibility', 'hidden')
        //        }
                //if ($('#ChequeNumber').val().trim() == '') {
                //    isValidItem = false;
                //    $('#ChequeNumber').siblings('span.error').css('visibility', 'visible');

                //}
                //else {

                //    $('#ChequeNumber').siblings('span.error').css('visibility', 'hidden');
                //}

                //if (!($('#ChequeDate').val().trim() != '' && !isNaN($('#ChequeDate').val().trim))) {
                //    isValidItem = true;
                //    $('#ChequeDate').siblings('span.error').css('visibility', 'visible');

                //}
                //else {

                //    $('#ChequeDate').siblings('span.error').css('visibility', 'hidden');
                //}
                //if (!($('#TenantAgreementNumber').val().trim() != '' && !isNaN($('#TenantAgreementNumber').val().trim))) {
                //    isValidItem = false;
                //    $('#TenantAgreementNumber').siblings('span.error').css('visibility', 'visible');

                //}
                //else {

                //    $('#TenantAgreementNumber').siblings('span.error').css('visibility', 'hidden');
                //}
                //Add items to list if valid
                //if (isValidItem) {

                //    ChequeDetails.push({
                //        ChequeNumber: $('#ChequeNumber').val().trim(),
                //        //ChequeDate: $('#ChequeDate').val().trim(),
                //        TenantAgreementNumber: $('#TenantAgreementNumber').val().trim(),
                //        Amount: parseFloat($('#Amount').val().trim()) * parseFloat($('#Amount').val().trim())
                //    });
                //    $('#ChequeNumber').val('').focus;
                //    //$('#ChequeDate').val('').focus;
                //    $('#TenantAgreementNumber');
                //    //$('#Amount');

                //}
                //GeneratedItemsTable();

                //}
                //Add items to list
                //if (isValidItem) {
                //    ChequeDetails.push({
                //        ChequeNumber: $('#ChequeNumber').val().trim(),
                //        TenantAgreementNumber: $('#TenantAgreementNumber').val().trim(),
                //        Amount: parseInt($('#Amount').val().trim()),


                //    });

                //    //clear fields
                //    $('#ChequeNumber').val('').focus();
                //    $('#TenantAgreementNumber').val('');
                //    $('#Amount').val('');


                //}
                //populate items
            //    GeneratedItemsTable();

            //});
            //Save button click
            //$('#submit').click(function () {
            //    //validation order
            //    var isALLValidItem = true;

            //});


            //$('#submit').click(function () {
                //validation of order
                //var isAllValid = true;
                //if (ChequeDetails.length == 0) {

                //    $('#ChequeNumber').html('<span style = "color:red;">---Please Add---</span>');
                //    isAllValid = false;

                //}
                //if ($('#ChequeDate').val().trim() == '') {
                //    $('#ChequeDate').siblings('span.error').css('visibility', 'visible');
                //    isAllValid = false;


                //}

            //    else {

            //        $('#ChequeDate').siblings('span.error').css('visibility', 'hidden')
            //    } if ($('#TenantAgreementNumber').val().trim() == '') {
            //        $('#TenantAgreementNumber').siblings('span.error').css('visibility', 'visible');
            //        isAllValid = false;


            //    }

            //    else {

            //        $('#TenantAgreementNumber').siblings('span.error').css('visibility', 'hidden')
            //    }

            //if ($('#Amount').val().trim() == '') {
            //    $('#Amount').siblings('span.error').css('visibility', 'visible');
            //    isAllValid = false;


            //}

            //else {

            //    $('#Amount').siblings('span.error').css('visibility', 'hidden')
            //}

                //save if valid

                //if (isAllValid) {
                //    var data = {
                //        ChequeNumber: $('#ChequeNumber').val().trim(),
                //        ChequeDate: $('#ChequeDate').val().trim(),
                        //TenantAgreementNumber: $('#TenantAgreementNumber').val().trim(),
                    //    AgreementDetails: ChequeDetails;
                    //}
                    //$(this).val('Please Wait...');
                    //$.ajax({

                    //    url: 'URL FOR POST ACTION HERE',
                    //    type: "POST",
                    //    data: JSON.stringify(data),
                    //    dataType: "JSON",
                    //    contentType: "application/JSON",
                    //    success: function (d) {

                            //CHECK IS SUCCESSFULLY save to database
                            //if (d.ChequeNumber == true) {
                                //will send status from server side
                                //alert('Great You are Successfully Done!')
                                //clear form
                            //    ChequeDetails = [];

                            //    $('#ChequeDate').val('');
                            //    $('TenantAgreementNumbe').val('');
                            //    $('#ChequeNumber').empty();

                            //}

                            else {
                    //            alert('Failed');



                    //        }
                    //    },
                    //    error: function () {
                    //        alert('X Error, Please Try Again');
                    //    }
                    //});
                    //}





        //    });
        //    function GeneratedItemsTable() {
        //        if (ChequeDetails.length > 0) {
        //            var $table = $('<table/>');
        //            $table.append('<thead><tr><th>Cheque Number</th><th>Cheque Date</th><th>Tenant Agreement Number</th><th>Amount</th></tr></thead>');
        //            var $tbody = $('<tbody/>');
        //            $.each(ChequeDetails, funtion(i, val) {
        //            var $row = $('<tr/>');
        //            $row.append($('<td/>').html(val.ChequeNumber));
        //            $row.append($('<td/>').html(val.ChequeDate));
        //            $row.append($('<td/>').html(val.TenantAgreementNumber));
        //            $row.append($('<td/>').html(val.Amount));
        //                $tbody.append($row);
        //        });
        //            $table.append($tbody);
        //            $('#ChequeDetails').html($table);


        //    }
        //}
        //});


        @*<link href="@Url.Content("~/Content/Gridmvc.css")" rel="stylesheet" />
        <link href="@Url.Content("~/Content/bootstrap.min.css")" rel="stylesheet" />*@




    </script>





}